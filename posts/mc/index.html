<!doctype html><html lang=en><head><title>Marching Cube Algorithm · AI for HUMANITY</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Mohamed ABDUL GAFOOR"><meta name=description content="Marching Cube Algorithm - an overview:
The Marching Cube Algorithm is a well known algorithm in computer graphics and scientific visualization for creating a 3D surface mesh from a 3D scalar field. The input of marching cube algorithm is a 3D voxels or 3D coordinate points and the output is a triangular mesh that represents the isosurface of the scalar field.
The basic idea of the algorithm is to divide the input volume into a regular grid of cubes, with each cube having 8 corners."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Marching Cube Algorithm"><meta name=twitter:description content="Marching Cube Algorithm - an overview:
The Marching Cube Algorithm is a well known algorithm in computer graphics and scientific visualization for creating a 3D surface mesh from a 3D scalar field. The input of marching cube algorithm is a 3D voxels or 3D coordinate points and the output is a triangular mesh that represents the isosurface of the scalar field.
The basic idea of the algorithm is to divide the input volume into a regular grid of cubes, with each cube having 8 corners."><meta property="og:title" content="Marching Cube Algorithm"><meta property="og:description" content="Marching Cube Algorithm - an overview:
The Marching Cube Algorithm is a well known algorithm in computer graphics and scientific visualization for creating a 3D surface mesh from a 3D scalar field. The input of marching cube algorithm is a 3D voxels or 3D coordinate points and the output is a triangular mesh that represents the isosurface of the scalar field.
The basic idea of the algorithm is to divide the input volume into a regular grid of cubes, with each cube having 8 corners."><meta property="og:type" content="article"><meta property="og:url" content="https://AIThoughtLab.github.io/ThinkingAI/posts/mc/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-18T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-18T00:00:00+00:00"><link rel=canonical href=https://AIThoughtLab.github.io/ThinkingAI/posts/mc/><link rel=preload href="https://AIThoughtLab.github.io/ThinkingAI/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://AIThoughtLab.github.io/ThinkingAI/css/coder.min.36f76aaf39a14ecf5c3a3c6250dcaf06c238b3d8365d17d646f95cb1874e852b.css integrity="sha256-NvdqrzmhTs9cOjxiUNyvBsI4s9g2XRfWRvlcsYdOhSs=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://AIThoughtLab.github.io/ThinkingAI/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://AIThoughtLab.github.io/ThinkingAI/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://AIThoughtLab.github.io/ThinkingAI/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://AIThoughtLab.github.io/ThinkingAI/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://AIThoughtLab.github.io/ThinkingAI/images/apple-touch-icon.png><link rel=manifest href=https://AIThoughtLab.github.io/ThinkingAI/site.webmanifest><link rel=mask-icon href=https://AIThoughtLab.github.io/ThinkingAI/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.111.2"></head><body class="preload-transitions colorscheme-dark"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://AIThoughtLab.github.io/ThinkingAI/>AI for HUMANITY</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/innovations/>Innovations</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/personal/>Personal</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://AIThoughtLab.github.io/ThinkingAI/posts/mc/>Marching Cube Algorithm</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2022-05-18T00:00:00Z>May 18, 2022</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
4-minute read</span></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=https://AIThoughtLab.github.io/ThinkingAI/categories/computer-graphics/>Computer Graphics</a>
<span class=separator>•</span>
<a href=https://AIThoughtLab.github.io/ThinkingAI/categories/computational-geometry/>Computational Geometry</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://AIThoughtLab.github.io/ThinkingAI/tags/marching-cubes/>Marching Cubes</a></span>
<span class=separator>•</span>
<span class=tag><a href=https://AIThoughtLab.github.io/ThinkingAI/tags/3d-reconstruction/>3D Reconstruction</a></span></div></div></header><div class=post-content><p><strong>Marching Cube Algorithm - an overview:</strong></p><p>The Marching Cube Algorithm is a well known algorithm in computer graphics and scientific visualization for creating a 3D surface mesh from a 3D scalar field.
The input of marching cube algorithm is a 3D voxels or 3D coordinate points and the output is a triangular mesh that represents the isosurface of the scalar field.</p><p>The basic idea of the algorithm is to divide the input volume into a regular grid of cubes, with each cube having 8 corners. If all 8 corners of a cube have positive numbers or all 8 corners have negative numbers, then the whole cube will either be above or below a certain surface. When this happens, <strong>no triangles will be created</strong>. Technically 256 possible configurations (2 power 8). However, several of these configurations are equivalent to one another. Therefore, only 15 unique cases exist, which are displayed here:</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/mc.png></figure><p>Then, for each cube, the algorithm determines the subset of the cube&rsquo;s faces that are intersected by the isosurface of the scalar field. This information is used to generate a set of triangular facets that approximate the surface of the isosurface. The output of the algorithm is a triangular mesh that can be rendered using standard graphics techniques. The mesh is guaranteed to be topologically correct, meaning that it does not contain any holes or self-intersections, and it approximates the isosurface of the scalar field to within a specified tolerance.</p><p>In this blog we will use a Python library called <strong>mcubes</strong>, which provides tools for generating isosurfaces from volumetric data using the Marching Cubes algorithm. This library is useful for extracting surfaces from 3D medical imaging data, in our case 3D MRI (brats2020)</p><p>To utilize the mcubes library in Python, it can be installed by executing the command <strong>pip install &ndash;upgrade PyMCubes</strong>. This will download and install the latest version of the library, which can then be imported and utilized in Python scripts or notebooks for generating isosurfaces from volumetric data using the Marching Cubes algorithm. Github page of PyMCubes can be found <a href=https://github.com/pmneila/PyMCubes>here.</a></p><p>When dealing with the brats2020 dataset, the mcubes library can be utilized for reconstructing the 3D surface of brain tumors. This is done by processing the <strong>seg.nii</strong> data from training/validation sample or our own prediction. By utilizing the mcubes library, it is possible to generate accurate and visually appealing representations of the brain tumor surfaces, which can be analyzed and used in a variety of research and clinical applications. In brats2020 dataset, the segmentation masks have pixel values of 0, 1, 2 or 4, and we can identify 3 main type of tumors, namely, Whole tumor (WT), Tumor Core (TC) or Enhancing Tumor (ET).</p><p>Following is the code to reconstruct the 3D surfaces;</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>mcubes</span>
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>nibabel</span> <span style=font-weight:700>as</span> <span style=font-weight:700>nib</span>
</span></span><span style=display:flex><span><span style=font-weight:700>import</span> <span style=font-weight:700>numpy</span> <span style=font-weight:700>as</span> <span style=font-weight:700>np</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mask = nib.load(<span style=font-style:italic>&#39;seg.nii&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mask = np.array(mask.dataobj)
</span></span><span style=display:flex><span>print(np.unique(mask)) <span style=font-style:italic># Make sure the unique values</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mask_WT = mask.copy()   <span style=font-style:italic># WT = Whole tumor </span>
</span></span><span style=display:flex><span>mask_WT[mask_WT == 1] = 1
</span></span><span style=display:flex><span>mask_WT[mask_WT == 2] = 1
</span></span><span style=display:flex><span>mask_WT[mask_WT == 4] = 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mask_TC = mask.copy()   <span style=font-style:italic># Tumor Core </span>
</span></span><span style=display:flex><span>mask_TC[mask_TC == 1] = 1
</span></span><span style=display:flex><span>mask_TC[mask_TC == 2] = 0
</span></span><span style=display:flex><span>mask_TC[mask_TC == 4] = 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mask_ET = mask.copy()   <span style=font-style:italic># Enhancing Tumor</span>
</span></span><span style=display:flex><span>mask_ET[mask_ET == 1] = 0
</span></span><span style=display:flex><span>mask_ET[mask_ET == 2] = 0
</span></span><span style=display:flex><span>mask_ET[mask_ET == 4] = 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-style:italic># possible smooth functions;</span>
</span></span><span style=display:flex><span><span style=font-style:italic># mcubes.smooth_constrained</span>
</span></span><span style=display:flex><span><span style=font-style:italic># mcubes.smooth</span>
</span></span><span style=display:flex><span><span style=font-style:italic># mcubes.smooth_gaussian</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mask_list = [mask_WT, mask_TC, mask_ET]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>for</span> i,mask <span style=font-weight:700>in</span> enumerate(mask_list):
</span></span><span style=display:flex><span>  smoothed_nii = mcubes.smooth_gaussian(mask)
</span></span><span style=display:flex><span>  vertices, triangles = mcubes.marching_cubes(smoothed_nii, 0)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  mcubes.export_obj(vertices, triangles, <span style=font-style:italic>f</span><span style=font-style:italic>&#39;smooth_</span><span style=font-weight:700;font-style:italic>{</span>i<span style=font-weight:700;font-style:italic>}</span><span style=font-style:italic>.obj&#39;</span>)
</span></span></code></pre></div><p>Following is the 3D reconstructed model using mcubes library (Vertices: 24,924 and Triangles: 49,844), you can download the <strong>.obj</strong> files <a href="https://drive.google.com/drive/folders/1722pJRz2rbrzA9444djyHERRwrTH0xO0?usp=share_link">here.</a></p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/model.png></figure><p>There are many benefits of using 3D reconstruction in scientific and engineerinh domain because 3D reconstruction allows us to visualize objects and environments in 3D space. This can help us better understand complex structures and systems. Similarly, by creating accurate 3D models of objects and environments, we can make precise measurements and perform detailed analysis. This can be particularly useful in scientific research, engineering, and medical fields.</p></div><footer></footer></article></section></div><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></main><script src=https://AIThoughtLab.github.io/ThinkingAI/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>