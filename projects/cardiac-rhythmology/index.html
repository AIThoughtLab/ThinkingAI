<!doctype html><html lang=en><head><title>3D Reconstruction Based on Medical Imaging For Personalized Surgical Procedures In Cardiac Rhythmology · AI for HUMANITY</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Mohamed ABDUL GAFOOR"><meta name=description content="This is a short summary of my master thesis on VR at the Institut Polytechnique de Paris (IP Paris)
Abstract: Virtual Reality (VR) technology plays a vital role in Science and Engineering for immersive visualization and is a new interactive paradigm. The recent advancement in the processing power of computers have enabled tremendous opportunities for the increased use of VR technology in medicine and surgery. Preoperative planning of Catheter Ablation (CA) Therapy in the VR environment is an important immersive application not only to minimize the risk of intricacy during surgery but also to reduce the operating time, a method of training for novice surgeons and for patient education."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="3D Reconstruction Based on Medical Imaging For Personalized Surgical Procedures In Cardiac Rhythmology"><meta name=twitter:description content="This is a short summary of my master thesis on VR at the Institut Polytechnique de Paris (IP Paris)
Abstract: Virtual Reality (VR) technology plays a vital role in Science and Engineering for immersive visualization and is a new interactive paradigm. The recent advancement in the processing power of computers have enabled tremendous opportunities for the increased use of VR technology in medicine and surgery. Preoperative planning of Catheter Ablation (CA) Therapy in the VR environment is an important immersive application not only to minimize the risk of intricacy during surgery but also to reduce the operating time, a method of training for novice surgeons and for patient education."><meta property="og:title" content="3D Reconstruction Based on Medical Imaging For Personalized Surgical Procedures In Cardiac Rhythmology"><meta property="og:description" content="This is a short summary of my master thesis on VR at the Institut Polytechnique de Paris (IP Paris)
Abstract: Virtual Reality (VR) technology plays a vital role in Science and Engineering for immersive visualization and is a new interactive paradigm. The recent advancement in the processing power of computers have enabled tremendous opportunities for the increased use of VR technology in medicine and surgery. Preoperative planning of Catheter Ablation (CA) Therapy in the VR environment is an important immersive application not only to minimize the risk of intricacy during surgery but also to reduce the operating time, a method of training for novice surgeons and for patient education."><meta property="og:type" content="article"><meta property="og:url" content="https://AIThoughtLab.github.io/ThinkingAI/projects/cardiac-rhythmology/"><meta property="article:section" content="projects"><meta property="article:published_time" content="2021-09-05T00:00:00+00:00"><meta property="article:modified_time" content="2021-09-05T00:00:00+00:00"><link rel=canonical href=https://AIThoughtLab.github.io/ThinkingAI/projects/cardiac-rhythmology/><link rel=preload href="https://AIThoughtLab.github.io/ThinkingAI/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://AIThoughtLab.github.io/ThinkingAI/css/coder.min.36f76aaf39a14ecf5c3a3c6250dcaf06c238b3d8365d17d646f95cb1874e852b.css integrity="sha256-NvdqrzmhTs9cOjxiUNyvBsI4s9g2XRfWRvlcsYdOhSs=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://AIThoughtLab.github.io/ThinkingAI/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://AIThoughtLab.github.io/ThinkingAI/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://AIThoughtLab.github.io/ThinkingAI/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://AIThoughtLab.github.io/ThinkingAI/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://AIThoughtLab.github.io/ThinkingAI/images/apple-touch-icon.png><link rel=manifest href=https://AIThoughtLab.github.io/ThinkingAI/site.webmanifest><link rel=mask-icon href=https://AIThoughtLab.github.io/ThinkingAI/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.110.0"></head><body class="preload-transitions colorscheme-dark"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://AIThoughtLab.github.io/ThinkingAI/>AI for HUMANITY</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/innovations/>Innovations</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/personal/>Personal</a></li><li class=navigation-item><a class=navigation-link href=https://AIThoughtLab.github.io/ThinkingAI/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://AIThoughtLab.github.io/ThinkingAI/projects/cardiac-rhythmology/>3D Reconstruction Based on Medical Imaging For Personalized Surgical Procedures In Cardiac Rhythmology</a></h1></header><p><em>This is a short summary of my master thesis on VR at the Institut Polytechnique de Paris (IP Paris)</em></p><p><strong>Abstract</strong>:
Virtual Reality (VR) technology plays a vital role in Science and Engineering for immersive visualization and is a new interactive paradigm. The recent advancement
in the processing power of computers have enabled tremendous opportunities for the increased use of VR technology in medicine and surgery. Preoperative planning
of Catheter Ablation (CA) Therapy in the VR environment is an important immersive application not only to minimize the risk of intricacy during surgery but also
to reduce the operating time, a method of training for novice surgeons and for patient education. In this study, we demonstrate a 3D reconstruction of Left Atrium
(LA) from Computerized Tomography (CT) images and a complete immersive visualization and navigation of catheter in order to facilitate the surgical procedures.</p><p><strong>Background</strong>: Cardiovascular Diseases (CVDs), also known as heart diseases that affect the heart and the blood vessels of millions of people each year. According to the World Health
Organization, approximately 17.9 million people died from CVDs in 2019, which represents 32 % of all the global deaths1 . Findings from Global Burden of Disease
Study 2017 shows that even though there are cost-effective interventions available to prevent deaths from CVDs, for example, lower blood pressure or cholesterol, the
mortality rate has significantly increased since 2007 worldwide2 . In contrast, CVDs in high-income countries have declined substantially compared to the low-income
countries over the past half-century. Nevertheless, in high-income countries this long term trend has stagnated in recent years or even increased in younger populations.</p><p><strong>Project Scope and Motivation</strong>:
The main scope and the motivation behind this project is to facilitate the surgical procedure of the CA therapy for left atrial fibrillation. More specifically, the work is focused on patient-specific surgical planning where the patient’s 3D reconstructed heart model is used for the rehearsal purpose using the VR technology before the real surgery. It is therefore intended to design, develop and evaluate a new preoperative planning tool for the CA therapy for AF. The proposed hypothesis is that the developed VR application would allow the surgeons to take the right decision before the surgery and helps to increase the safety and the efficiency in the operating room. Moreover, this research can also be extended to the educational training program for young surgeons and as well as for the patient education. Here we will use three state of the art technologies; namely deep learning, computer vision and the virtual reality. At the end of the project, a working VR application will be developed to facilitate the surgical procedure that mainly involves immersive visualization and the navigation of catheter.</p><p><strong>Research Objectives</strong>:</p><p>The objectives are as follows:</p><ul><li>OBJECTIVE : 1 To apply U-Net architecture and/or a threshold techniques to segment CT images of left atrium.</li><li>OBJECTIVE : 2 To apply marching cubes algorithm for the 3D reconstruction of the segmented images.</li><li>OBJECTIVE : 3 To use Unity game engine for the simulation of immersive visualization and the navigation of catheter.</li></ul><p><strong>Image Segmentation Using U-Net</strong></p><p>U-Net is build upon a fully convolutional network, with certain modifications to its base architecture, which are more suitable for biomedical imaging applications.
It receives an image as an input and produce an output image with the same size as the original image.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/unet.png></figure><p>The figure above shows that the lowest resolution is 32x32 pixels. Blue boxes represent multi-channel feature map. In each boxes the number on top of it denotes
the channel number. For example, the input image is a 1-channel. The white boxes are copied feature map to the decoding layers. The outupt segmentation map contains two classes (foreground and background). The blue arrows represent the convolution operations and followed by a non-linear activation function. The Encoder (which is in the left side) part consists of repeated application of two
3x3 convolutions passing through ReLU activation functions, then 2x2 MaxPooling and the Dropout layer. Number of filters will increase in each stage and dimensionality of the features will be reduced using the pooling layer. In the Decoder (which is in the right side) each step consists of upsampling of the feature map, then deconvoluted by a 2x2 transpose which helps to halves number of feature channels. Also the network consists of concatenation with the corresponding feature map from the encoder path (contraction) to the decoder path (expension). In the final stage 1x1 convolution is used to get the desired output classes. Following figure shows the ground truth and predicted mask.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/gt.png></figure><p><strong>Image Segmentation Using Thresholding and follow up 3D reconstruction</strong></p><p>Thresholding is a basic segmentation technique used in many Computer Vision (CV)
tasks. In this technique, an image pixels are grouped depending on their intensity
values, which makes the images easier to analyze. A gray scale image converted into
binary using some conditions. For example, if the pixel value greater than a certain
value, we set to 1, otherwise we set to zero. i.e,</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/eq.png></figure><p>Where T is here the appropriate thresholding value. The below figure is an example, in which a thresholding technique was used to segment the left atrium. The
image was converted into a gray scale 8-bit image and a thresholding technique was applied. The histogram of the image in Figure 2.9 show that the image is segmented
using thresholding value of above 185. Note that the image pixel values are set to 0 to 255. This means all the values below 185 removed and only the values above will remain. This helps to remove the unnecessary regions around the image and to focus on the region of interest. This technique helps to distinct the chambers of heart.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/imageMask.png></figure><p>Following histogram shows the distribution of the pixel values for a given image.<figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/hist.png></figure></p><p>we segment the image using the information about the contrast material injection before the CT scan. However, we will find many other vessels and bones (ribs, vertebral) appear in the segmented image.
Hence the image must go through further refining process. Removing the bones and vessels can be easily achieved by using region labeling (region extraction) algorithms. Moreover, the catheter wires can be removed manually if necessary or else this can be removed when we do the cleansing process of the calibers. During the thresholding because of the noise sometimes the holes might appear
in the middle of the structures. These holes must be removed before we apply the cleaning process. Otherwise, it may bias the caliber computation. The figure below shows before and after removing the bones from the initial segmented image.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/bone.png></figure><p>Formation of tinny holes after thresholding, due to noise can be found here.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/noise.png></figure><p>The developed method for caliber computation consists of two main steps namely; candidates selection and distal reconstruction. We implement the same technique for the left atrium. The figure below shows the segmented slices (uncleaned) and the corresponding cleaned segmented region of interests.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/cal.png></figure><p>Similarly, the figure below shows the caliber computed image. After this step, again thresholding should be applied to the image to remove the vessels completely.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/cal1.png></figure><p>The following figure shows the full 3D rendered heart model in color heatmap with calibers and on the right side of the figure the corresponding heart model where are vessels are removed.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/rendered.png></figure><p><strong>Marching Cube algorithm</strong></p><p>In Marching Cube algorithm, the input data is a voxel information, ie, a scalar field //(V = f(x, y, z)//). It could be binary or not. If it is not a binary, the Marching Cube
algorithms needs an additional parameter in order to distinct the sample points inside or outside the surface. For the binary model, the interior or the exterior points
are separated and would obtain a surface like. If the model is not binary, we create a isosurface joining all the points from given isovalue. The figure below shows the points joining by the isovalues to form level surfaces (in this case level lines) that maps from $$R^{3} \Rightarrow R$$</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/march.png></figure><p>Hence the basic idea is that, in the Marching Cube algorithm the cube of size 2x2x2 traverses along the sample and in each cube the algorithm creates set of triangles. The output surface has to satisfy the conditions; such as it should be able to separate interior points with the exterior points and should be closed and orientable (surface normal vector). The figure below shows the closed and the orientable surface created with the Marching Cube algorithm.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/cube.png></figure><p>Finally the figures below shows the left atrium;</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/left.png></figure><p>and a complete 3D heart model (ready to be deployed in the Unity).</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/3dheart3.png></figure><p><strong>Catheter simulation</strong></p><p>A simulation of a catheter motion in a VR environment is a highly complex task. However, this is an important step in realizing the complexity when navigating
through the femoral vein to the left atrium. In this project we tested many ways to reach this and finally one method worked out well. In this method we create
many spheres as body parts of the catheter, and also we set a minimum distance between the body parts, i.e spheres, and moreover speed and the rotational speed are
set as convenient. Moreover we create a body prefabs in order to instantiate every prefabs, this step is good if we decided to include many body parts as possible. We
also create a camera game object so that the first sphere carries the camera game object to record the scene in front of it. Because of the homogeneous and the isotropic
nature of the sphere game object, rotation of the sphere (which carries the camera) is not going to be visible in the scene. To overcome, we create another game object to as a pointer that is attached to the first sphere.</p><p>Now once completed catheter successfull, we are ready to deploy it in the Unity evvironment along with the reconstructed heart.</p><figure class=center><img src=https://AIThoughtLab.github.io/ThinkingAI/images/load.png></figure><p>To see the navigation, check out the video <a href="https://drive.google.com/file/d/1j9OknpDit5P67tmhjr3F2mkblOGJnWji/view?usp=share_link">here</a> or to see the turn/snap turn check out <a href="https://drive.google.com/file/d/14KreEnKciH000x1wcRRG2NuOSKBail1Y/view?usp=share_link">here.</a></p></article></section></div><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></main><script src=https://AIThoughtLab.github.io/ThinkingAI/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>